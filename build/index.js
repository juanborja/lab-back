!function(e){var t={};function n(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t){e.exports=require("express")},function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(2);r(n(4)).config(),process.env.DB_USER&&process.env.DB_NAME&&process.env.DB_PASS&&process.env.DB_HOST||(console.log("Missing db configuration"),process.exit(1));const u=new i.Sequelize(process.env.DB_NAME,process.env.DB_USER,process.env.DB_PASS,{host:process.env.DB_HOST,dialect:"mysql",logging:"production"!==process.env.ENV});t.default=u},function(e,t){e.exports=require("sequelize")},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;const s=a(n(1)),r=n(2);class i extends r.Model{}t.Item=i,i.init({id:{type:r.DataTypes.INTEGER.UNSIGNED,autoIncrement:!0,primaryKey:!0},name:{type:new r.DataTypes.STRING(128),allowNull:!1},description:{type:new r.DataTypes.STRING(128),allowNull:!0}},{sequelize:s.default,tableName:"item",paranoid:!0}),(async()=>{await s.default.sync()})(),(async()=>{await s.default.sync()})()},function(e,t){e.exports=require("dotenv")},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=a(n(1)),r=n(2),i=s.default.define("client",{id:{type:r.DataTypes.INTEGER.UNSIGNED,autoIncrement:!0,primaryKey:!0},name:{type:new r.DataTypes.STRING(128),allowNull:!1},lastname:{type:new r.DataTypes.STRING(128),allowNull:!1},company:{type:new r.DataTypes.STRING(128),allowNull:!1},position:{type:new r.DataTypes.STRING(128),allowNull:!1},phone:{type:r.DataTypes.BIGINT,allowNull:!1},mail:{type:new r.DataTypes.STRING(128),allowNull:!1},observations:{type:new r.DataTypes.STRING(128),allowNull:!1}},{paranoid:!0,tableName:"client"});i.belongsTo(i,{as:"reference"}),(async()=>{await s.default.sync()})(),t.default=i},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Budget=void 0;const s=a(n(1)),r=n(2),i=a(n(5));class u extends r.Model{}t.Budget=u,u.init({id:{type:r.DataTypes.INTEGER.UNSIGNED,autoIncrement:!0,primaryKey:!0},status:{type:new r.DataTypes.STRING(128)},inCharge:{type:new r.DataTypes.STRING(128)},date:{type:new r.DataTypes.DATE},reminder:{type:new r.DataTypes.DATE},observations:{type:new r.DataTypes.STRING(128),allowNull:!0}},{sequelize:s.default,paranoid:!0,tableName:"budget"}),u.belongsTo(i.default,{as:"owner"}),(async()=>{await s.default.sync()})()},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const u=n(9),o=r(n(4)),c=i(n(0)),d=i(n(11)),l=i(n(12)),f=n(13),y=n(15),p=i(n(17));o.config(),process.env.PORT||process.exit(1);const _=parseInt(process.env.PORT,10),m=c.default();m.use(l.default()),m.use(d.default()),m.use(c.default.json()),m.use("/clients",f.clientsRouter),m.use("/budgets",y.budgetsRouter),m.use("/items",u.itemsRouter),p.default();m.listen(_,()=>{console.log("Listening on port "+_)})},function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.itemsRouter=void 0;const u=i(n(0)),o=r(n(10));t.itemsRouter=u.default.Router(),t.itemsRouter.get("/",async(e,t)=>{try{const e=await o.findAll();t.status(200).send(e)}catch(e){t.status(404).send(e.message)}}),t.itemsRouter.get("/:id",async(e,t)=>{const n=parseInt(e.params.id,10);try{const e=await o.find(n);t.status(200).send(e)}catch(e){t.status(404).send(e.message)}}),t.itemsRouter.post("/",async(e,t)=>{try{const n=await o.create(e.body.item);t.status(201).send({item:n})}catch(e){t.status(404).send(e.message)}}),t.itemsRouter.put("/",async(e,t)=>{try{const n=await o.update(e.body.id,e.body.item);t.status(200).send({item:n})}catch(e){t.status(404).send(e.message)}}),t.itemsRouter.delete("/",async(e,t)=>{try{const n=await o.remove(e.body.id);t.status(200).send({item:n})}catch(e){t.status(404).send(e.message)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.remove=t.create=t.find=t.findAll=void 0;const a=n(3);t.findAll=async()=>a.Item.findAll(),t.find=async e=>{const t=a.Item.findByPk(e);if(!t)throw new Error("No se encontro el item");return t},t.create=async e=>(await a.Item.create(e),a.Item.findByPk(e.id)),t.remove=async e=>(await a.Item.destroy({where:{id:e}}),a.Item.findByPk(e)),t.update=async(e,t)=>(await a.Item.update(t,{where:{id:e}}),a.Item.findByPk(e))},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("helmet")},function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.clientsRouter=void 0;const u=i(n(0)),o=r(n(14));t.clientsRouter=u.default.Router(),t.clientsRouter.get("/",async(e,t)=>{try{const e=await o.findAll();t.status(200).send(e)}catch(e){t.status(404).send(e.message)}}),t.clientsRouter.get("/:id",async(e,t)=>{const n=parseInt(e.params.id,10);try{const e=await o.find(n);t.status(200).send(e)}catch(e){t.status(404).send(e.message)}}),t.clientsRouter.post("/",async(e,t)=>{try{const n=await o.create(e.body.client);t.status(201).send({client:n})}catch(e){t.status(404).send(e.message)}}),t.clientsRouter.put("/",async(e,t)=>{try{const n=await o.update(e.body.id,e.body.client);t.status(200).send({client:n})}catch(e){t.status(404).send(e.message)}}),t.clientsRouter.delete("/",async(e,t)=>{try{const n=await o.remove(e.body.id);t.status(200).send({client:n})}catch(e){t.status(404).send(e.message)}})},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.remove=t.create=t.find=t.findAll=void 0;const s=a(n(5));t.findAll=async()=>s.default.findAll({include:[{model:s.default,as:"reference"}]}),t.find=async e=>{const t=s.default.findByPk(e);if(!t)throw new Error("No se encontro el cliente");return t},t.create=async e=>(await s.default.create(e),s.default.findByPk(e.id)),t.remove=async e=>(await s.default.destroy({where:{id:e}}),s.default.findByPk(e)),t.update=async(e,t)=>(await s.default.update(t,{where:{id:e}}),s.default.findByPk(e))},function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.budgetsRouter=void 0;const u=i(n(0)),o=r(n(16));t.budgetsRouter=u.default.Router(),t.budgetsRouter.get("/",async(e,t)=>{try{const e=await o.findAll();t.status(200).send(e)}catch(e){t.status(404).send(e.message)}}),t.budgetsRouter.get("/:id",async(e,t)=>{const n=parseInt(e.params.id,10);try{const e=await o.find(n);t.status(200).send(e)}catch(e){t.status(404).send(e.message)}}),t.budgetsRouter.post("/",async(e,t)=>{try{const n=await o.create(e.body.budget,e.body.items);t.status(201).send({budget:n})}catch(e){t.status(404).send(e.message)}}),t.budgetsRouter.put("/",async(e,t)=>{try{const n=await o.update(e.body.id,e.body.budget,e.body.items);t.status(200).send({budget:n})}catch(e){t.status(404).send(e.message)}}),t.budgetsRouter.delete("/",async(e,t)=>{try{const n=await o.remove(e.body.id);t.status(200).send({budget:n})}catch(e){t.status(404).send(e.message)}})},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.remove=t.create=t.find=t.findAll=void 0;const s=a(n(1)),r=n(6);t.findAll=async()=>r.Budget.findAll(),t.find=async e=>{const t=r.Budget.findByPk(e);if(!t)throw new Error("No se encontro el presupuesto");return t},t.create=async(e,t)=>{const n=await s.default.transaction(),a=await r.Budget.create(e,{transaction:n});if(t)try{await a.addItems(t,{transaction:n})}catch(e){throw n.rollback(),e}return await n.commit(),a},t.remove=async e=>(await r.Budget.destroy({where:{id:e}}),r.Budget.findByPk(e,{paranoid:!1})),t.update=async(e,t,n)=>{const a=await s.default.transaction(),i=await r.Budget.findByPk(e);if(await r.Budget.update(t,{where:{id:e},transaction:a}),n&&i)try{await i.addItems(n,{transaction:a})}catch(e){throw a.rollback(),e}return await a.commit(),r.Budget.findByPk(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(3),s=n(6);t.default=()=>{s.Budget.belongsToMany(a.Item,{through:"budgetItems"}),a.Item.belongsToMany(s.Budget,{through:"budgetItems"})}}]);