!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=require("dotenv")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.remove=t.create=t.find=t.findAll=void 0;const s=o(n(10));t.findAll=async(e,t,n)=>s.default.findAndCountAll({limit:t,offset:e*t,attributes:n}),t.find=async e=>{const t=s.default.findByPk(e);if(!t)throw new Error("No se encontro registro");return t},t.create=async e=>{const t=await s.default.create(e);return s.default.findByPk(t.id)},t.remove=async e=>(await s.default.destroy({where:{id:e}}),s.default.findByPk(e,{paranoid:!1})),t.update=async(e,t)=>(await s.default.update(t,{where:{id:e}}),s.default.findByPk(e))},function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("express-validator/check")},function(e,t,n){e.exports=n(6)},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(0)),u=a(n(1)),c=a(n(7)),l=a(n(8)),d=n(9);i.config(),process.env.PORT||process.exit(1);const f=u.default();f.use(l.default()),f.use(c.default()),f.use(u.default.json()),f.use("/api/stocks",d.stockRouter);f.listen(8888,()=>{console.log("Listening on port 8888")})},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("helmet")},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.stockRouter=void 0;const i=a(n(1)),u=r(n(2)),c=n(4),l=a(n(12)),d=n(14);t.stockRouter=i.default.Router(),t.stockRouter.get("/",async(e,t)=>{var n,o,s,r,a,i;try{const c=(null===(n=e.query)||void 0===n?void 0:n.page)?Number(null===(o=e.query)||void 0===o?void 0:o.page):0,l=(null===(s=e.query)||void 0===s?void 0:s.size)?Number(null===(r=e.query)||void 0===r?void 0:r.size):10,d=(null===(a=e.query)||void 0===a?void 0:a.fields)?(null===(i=e.query)||void 0===i?void 0:i.fields).replace(/ /g,"").split(","):["id"],f=await u.findAll(c,l,d);t.status(200).send(f)}catch(e){t.status(404).send(e.message)}}),t.stockRouter.get("/:id",async(e,t)=>{const n=parseInt(e.params.id,10);try{const e=await u.find(n);e||t.status(400).send("Registro no encontrado"),t.status(200).send(e)}catch(e){t.status(400).send(e.message)}}),t.stockRouter.post("/",[...d.REQUIRED,...d.TYPES],async(e,t)=>{const n=c.validationResult(e);if(!n.isEmpty())return t.status(400).jsonp(n.array());try{const n=await u.create(e.body);t.status(201).send({stock:n})}catch(e){t.status(400).send(e.message)}}),t.stockRouter.put("/:id",[...d.TYPES],async(e,t)=>{try{const n=parseInt(e.params.id,10),o=c.validationResult(e);if(!o.isEmpty())return t.status(400).jsonp(o.array());const s=await u.update(n,e.body);t.status(200).send({stock:s})}catch(e){t.status(400).send(e.message)}}),t.stockRouter.delete("/:id",async(e,t)=>{try{const n=parseInt(e.params.id,10),o=await u.remove(n);t.status(200).send({stock:o})}catch(e){t.status(400).send(e.message)}}),t.stockRouter.post("/seed/:amount",async(e,t)=>{try{const n=parseInt(e.params.amount,10);await l.default(n),t.status(201).send(n+" registers added")}catch(e){t.status(400).send(e.message)}})},function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(11)),r=n(3);class a extends r.Model{}a.init({id:{type:r.DataTypes.INTEGER.UNSIGNED,autoIncrement:!0,primaryKey:!0},date:{type:new r.DataTypes.DATE,allowNull:!1},last:{type:new r.DataTypes.FLOAT,allowNull:!1},open:{type:new r.DataTypes.FLOAT,allowNull:!1},max:{type:new r.DataTypes.FLOAT,allowNull:!1},min:{type:new r.DataTypes.FLOAT,allowNull:!1},vol:{type:new r.DataTypes.FLOAT,allowNull:!1}},{paranoid:!0,sequelize:s.default,tableName:"stocks"}),(async()=>{await s.default.sync()})(),t.default=a},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(3);r(n(0)).config(),process.env.DB_USER&&process.env.DB_NAME&&process.env.DB_PASS&&process.env.DB_HOST||(console.log("Missing db configuration"),process.exit(1));const i=new a.Sequelize(process.env.DB_NAME,process.env.DB_USER,process.env.DB_PASS,{host:process.env.DB_HOST,port:Number(process.env.DB_PORT),dialect:"mysql",logging:"production"!==process.env.ENV});t.default=i},function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(2)),u=a(n(13));t.default=async e=>{const t=new Date;for(let n=0;n<e;n++)await i.create({id:0,date:t,last:u.default.random.number({min:3e3,max:3400}),open:u.default.random.number({min:3e3,max:3400}),max:u.default.random.number({min:3e3,max:3400}),min:u.default.random.number({min:3e3,max:3400}),vol:u.default.random.number({min:3,max:10})}),t.setDate(t.getDate()+1)}},function(e,t){e.exports=require("faker")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TYPES=t.REQUIRED=void 0;const o=n(4),s=[o.check("date").not().isEmpty().withMessage("Date is required"),o.check("open").not().isEmpty().withMessage("Open is required"),o.check("min").not().isEmpty().withMessage("Min is required"),o.check("max").not().isEmpty().withMessage("Max is required"),o.check("vol").not().isEmpty().withMessage("Vol is required"),o.check("last").not().isEmpty().withMessage("Last is required")];t.REQUIRED=s;const r=[o.check("open").optional().toFloat().isFloat().withMessage("Open must be float"),o.check("min").optional().toFloat().isFloat().withMessage("Min must be float"),o.check("max").optional().toFloat().isFloat().withMessage("Max must be float"),o.check("vol").optional().toFloat().isFloat().withMessage("Vol must be float"),o.check("last").optional().toFloat().isFloat().withMessage("Last must be float")];t.TYPES=r}]);